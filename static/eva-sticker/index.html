<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NERV STICKER GENERATOR // SYSTEM</title>
    <!-- 
        FONT NOTE:
        ==========
        This project uses Google Fonts' free alternatives to approximate the EVA aesthetic.
        
        Original EVA fonts (for reference):
        - Matisse EB: The iconic typeface used in NGE title cards and NERV UI (Fontworks)
        - Nimbus Roman No. 9 Std: NERV logo font
        
        Current free alternatives used:
        - Zen Old Mincho 900 (Black): Best free alternative to Matisse EB
        - Noto Serif JP: Fallback Japanese serif
        - Shippori Mincho: Secondary fallback
        
        To use the authentic Matisse EB:
        - Subscribe to mojimo-EVA: https://www.mojimo.jp/eva/
        - Price: 999 JPY/year (~50 CNY)
        - Includes: EVA-Matisse-Classic (TV series) + EVA-Matisse-Standard (Rebuild)
    -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Noto+Sans+JP:wght@400;700;900&family=Noto+Serif+JP:wght@400;700;900&family=Noto+Serif+SC:wght@400;700;900&family=Zen+Old+Mincho:wght@400;700;900&family=Oswald:wght@400;500;700&family=Share+Tech+Mono&family=Shippori+Mincho:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --nerv-orange: #FF6B35;
            --nerv-purple: #7B1FA2;
            --magi-green: #00E676;
            --terminal-cyan: #00BCD4;
            --alert-red: #F44336;
            --at-field: #FFC107;
            --dark-bg: #0a0a0f;
            --panel-bg: rgba(10, 10, 15, 0.9);
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: var(--dark-bg);
            min-height: 100vh;
            color: #fff;
            overflow-x: hidden;
        }

        /* Hexagonal Grid Background */
        .bg-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(30deg, rgba(0, 188, 212, 0.03) 12%, transparent 12.5%, transparent 87%, rgba(0, 188, 212, 0.03) 87.5%, rgba(0, 188, 212, 0.03)),
                linear-gradient(150deg, rgba(0, 188, 212, 0.03) 12%, transparent 12.5%, transparent 87%, rgba(0, 188, 212, 0.03) 87.5%, rgba(0, 188, 212, 0.03)),
                linear-gradient(30deg, rgba(0, 188, 212, 0.03) 12%, transparent 12.5%, transparent 87%, rgba(0, 188, 212, 0.03) 87.5%, rgba(0, 188, 212, 0.03)),
                linear-gradient(150deg, rgba(0, 188, 212, 0.03) 12%, transparent 12.5%, transparent 87%, rgba(0, 188, 212, 0.03) 87.5%, rgba(0, 188, 212, 0.03)),
                linear-gradient(60deg, rgba(123, 31, 162, 0.02) 25%, transparent 25.5%, transparent 75%, rgba(123, 31, 162, 0.02) 75%, rgba(123, 31, 162, 0.02)),
                linear-gradient(60deg, rgba(123, 31, 162, 0.02) 25%, transparent 25.5%, transparent 75%, rgba(123, 31, 162, 0.02) 75%, rgba(123, 31, 162, 0.02));
            background-size: 80px 140px;
            background-position: 0 0, 0 0, 40px 70px, 40px 70px, 0 0, 40px 70px;
            pointer-events: none;
            z-index: 0;
        }

        /* Scanline Effect */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.1) 50%,
                rgba(0,0,0,0.1)
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 1;
            opacity: 0.3;
        }

        .container {
            position: relative;
            z-index: 2;
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header - NERV Style */
        header {
            background: linear-gradient(180deg, rgba(123, 31, 162, 0.2) 0%, transparent 100%);
            border-bottom: 2px solid var(--nerv-orange);
            padding: 30px 40px;
            margin-bottom: 40px;
            position: relative;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--nerv-orange), var(--terminal-cyan), var(--nerv-orange));
            animation: headerGlow 3s ease-in-out infinite;
        }

        @keyframes headerGlow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section h1 {
            font-family: 'Oswald', sans-serif;
            font-size: 2.8rem;
            font-weight: 400;
            letter-spacing: 0.2em;
            color: var(--nerv-orange);
            text-shadow: 
                0 0 10px rgba(255, 107, 53, 0.8),
                0 0 20px rgba(255, 107, 53, 0.4),
                0 0 40px rgba(255, 107, 53, 0.2);
            margin-bottom: 5px;
        }

        .logo-section .subtitle {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.9rem;
            color: var(--terminal-cyan);
            letter-spacing: 0.5em;
            text-transform: uppercase;
        }

        .system-info {
            text-align: right;
            font-family: 'Share Tech Mono', monospace;
        }

        .system-info .status {
            color: var(--magi-green);
            font-size: 0.8rem;
            margin-bottom: 5px;
        }

        .system-info .time {
            color: var(--terminal-cyan);
            font-size: 1.2rem;
        }

        /* Main Layout */
        .main-content {
            display: grid;
            grid-template-columns: 380px 1fr;
            gap: 30px;
        }

        /* Control Panel - Terminal Style */
        .controls {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 188, 212, 0.3);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--terminal-cyan), transparent);
        }

        .panel-header {
            background: rgba(0, 188, 212, 0.1);
            padding: 15px 20px;
            border-bottom: 1px solid rgba(0, 188, 212, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .panel-header::before {
            content: '▶';
            color: var(--terminal-cyan);
            font-family: 'Share Tech Mono', monospace;
        }

        .panel-header h2 {
            font-family: 'Oswald', sans-serif;
            font-size: 0.9rem;
            color: var(--terminal-cyan);
            letter-spacing: 0.2em;
            text-transform: uppercase;
        }

        .panel-content {
            padding: 25px;
        }

        .control-group {
            margin-bottom: 25px;
            position: relative;
        }

        .control-group label {
            display: block;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.75rem;
            color: var(--terminal-cyan);
            margin-bottom: 8px;
            letter-spacing: 0.1em;
            text-transform: uppercase;
        }

        .control-group label::before {
            content: '>';
            margin-right: 8px;
            color: var(--nerv-orange);
        }

        .control-group input[type="text"],
        .control-group textarea,
        .control-group select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 188, 212, 0.3);
            border-radius: 2px;
            color: #fff;
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .control-group input[type="text"]:focus,
        .control-group textarea:focus,
        .control-group select:focus {
            outline: none;
            border-color: var(--terminal-cyan);
            box-shadow: 0 0 10px rgba(0, 188, 212, 0.3);
        }

        .control-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        /* Color Grid */
        .color-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .color-option {
            aspect-ratio: 1;
            border: 2px solid transparent;
            border-radius: 2px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'M PLUS 1p', sans-serif;
            font-weight: 900;
            font-size: 1rem;
        }

        .color-option:hover {
            transform: scale(1.05);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .color-option.active {
            border-color: #fff;
            box-shadow: 
                0 0 10px currentColor,
                inset 0 0 20px rgba(255, 255, 255, 0.2);
        }

        .color-option.active::after {
            content: '◆';
            position: absolute;
            bottom: 2px;
            right: 2px;
            font-size: 0.6rem;
            color: #fff;
        }

        /* Sliders */
        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 2px;
        }

        .slider-container input[type="range"] {
            flex: 1;
            -webkit-appearance: none;
            height: 4px;
            background: rgba(0, 188, 212, 0.2);
            border-radius: 2px;
            outline: none;
        }

        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: var(--terminal-cyan);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 188, 212, 0.5);
        }

        .slider-value {
            min-width: 50px;
            text-align: center;
            font-family: 'Share Tech Mono', monospace;
            color: var(--terminal-cyan);
            font-size: 0.9rem;
        }

        /* Checkboxes */
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 12px;
            cursor: pointer;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 2px;
            border: 1px solid rgba(0, 188, 212, 0.2);
        }

        .checkbox-container input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--terminal-cyan);
            cursor: pointer;
        }

        .checkbox-container span {
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.8rem;
            color: #fff;
        }

        /* Preview Section */
        .preview-section {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .preview-container {
            background: var(--panel-bg);
            border: 1px solid rgba(0, 188, 212, 0.3);
            border-radius: 4px;
            padding: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 500px;
            position: relative;
            overflow: hidden;
        }

        .preview-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--terminal-cyan), transparent);
        }

        .preview-label {
            position: absolute;
            top: 15px;
            left: 20px;
            font-family: 'Share Tech Mono', monospace;
            font-size: 0.7rem;
            color: var(--terminal-cyan);
            letter-spacing: 0.2em;
            text-transform: uppercase;
        }

        .preview-label::before {
            content: '◈ ';
        }

        /* Sticker Preview */
        #sticker-preview {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Noto Serif SC', 'Noto Serif JP', 'Zen Old Mincho', 'Shippori Mincho', 'Noto Sans JP', serif;
            font-weight: 900;
            text-align: center;
            line-height: 1.3;
            transition: all 0.3s;
            word-break: break-word;
            overflow: hidden;
            position: relative;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            letter-spacing: 0.05em;
            /* Matisse EB style compression */
            transform: scaleX(0.85);
        }

        #sticker-preview .sticker-header {
            font-size: 0.4em;
            margin-bottom: 0.3em;
            opacity: 0.9;
        }

        #sticker-preview .sticker-main {
            font-size: 1em;
        }

        #sticker-preview.single .sticker-main {
            font-size: 1em;
        }

        #sticker-preview.square {
            width: 400px;
            height: 400px;
            padding: 20px;
        }

        #sticker-preview.rectangle {
            width: 533px;
            height: 400px;
            padding: 20px 40px;
        }

        #sticker-preview.vertical {
            writing-mode: vertical-rl;
            text-orientation: upright;
            /* Adjust scale for vertical mode */
            transform: scaleY(0.85);
        }

        /* Download Button */
        .action-bar {
            display: flex;
            gap: 15px;
        }

        .download-btn {
            flex: 1;
            background: linear-gradient(135deg, rgba(255, 107, 53, 0.2) 0%, rgba(255, 107, 53, 0.1) 100%);
            color: var(--nerv-orange);
            border: 1px solid var(--nerv-orange);
            padding: 18px 40px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 53, 0.3), transparent);
            transition: left 0.5s;
        }

        .download-btn:hover {
            background: rgba(255, 107, 53, 0.3);
            box-shadow: 
                0 0 20px rgba(255, 107, 53, 0.4),
                inset 0 0 20px rgba(255, 107, 53, 0.1);
        }

        .download-btn:hover::before {
            left: 100%;
        }

        /* Responsive */
        @media (max-width: 1000px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            #sticker-preview.square {
                width: 280px;
                height: 280px;
            }

            #sticker-preview.rectangle {
                width: 320px;
                height: 240px;
            }

            .header-content {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .system-info {
                text-align: center;
            }

            .container {
                padding: 15px;
            }

            header {
                padding: 20px;
                margin-bottom: 25px;
            }

            .logo-section h1 {
                font-size: 2rem;
            }

            .preview-container {
                padding: 25px;
                min-height: 350px;
            }

            .panel-content {
                padding: 20px;
            }

            .download-btn {
                padding: 15px 30px;
                font-size: 0.9rem;
            }
        }

        /* Tablet */
        @media (max-width: 768px) {
            .container {
                padding: 12px;
            }

            header {
                padding: 15px;
                margin-bottom: 20px;
            }

            .logo-section h1 {
                font-size: 1.8rem;
                letter-spacing: 0.15em;
            }

            .logo-section .subtitle {
                font-size: 0.75rem;
                letter-spacing: 0.3em;
            }

            .system-info .status {
                font-size: 0.7rem;
            }

            .system-info .time {
                font-size: 1rem;
            }

            .panel-header {
                padding: 12px 15px;
            }

            .panel-header h2 {
                font-size: 0.8rem;
            }

            .panel-content {
                padding: 15px;
            }

            .control-group {
                margin-bottom: 18px;
            }

            .control-group label {
                font-size: 0.7rem;
                margin-bottom: 6px;
            }

            .control-group input[type="text"],
            .control-group textarea,
            .control-group select {
                padding: 10px 12px;
                font-size: 0.9rem;
            }

            .color-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
            }

            .color-option {
                font-size: 0.85rem;
            }

            .slider-container {
                padding: 8px;
            }

            .slider-value {
                font-size: 0.8rem;
                min-width: 40px;
            }

            .preview-container {
                padding: 20px;
                min-height: 300px;
            }

            #sticker-preview.square {
                width: 240px;
                height: 240px;
            }

            #sticker-preview.rectangle {
                width: 280px;
                height: 210px;
            }

            #sticker-preview {
                font-size: 0.8em;
            }

            .action-bar {
                flex-direction: column;
                gap: 12px;
            }

            .download-btn {
                width: 100%;
                padding: 14px 20px;
                font-size: 0.85rem;
            }
        }

        /* Mobile */
        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            header {
                padding: 12px;
                margin-bottom: 15px;
                border-bottom-width: 1px;
            }

            header::before {
                height: 2px;
            }

            .logo-section h1 {
                font-size: 1.5rem;
                letter-spacing: 0.1em;
            }

            .logo-section .subtitle {
                font-size: 0.65rem;
                letter-spacing: 0.2em;
            }

            .system-info .status {
                font-size: 0.6rem;
            }

            .system-info .time {
                font-size: 0.9rem;
            }

            .controls {
                border-radius: 3px;
            }

            .panel-header {
                padding: 10px 12px;
            }

            .panel-header h2 {
                font-size: 0.7rem;
                letter-spacing: 0.15em;
            }

            .panel-content {
                padding: 12px;
            }

            .control-group {
                margin-bottom: 15px;
            }

            .control-group label {
                font-size: 0.65rem;
                margin-bottom: 5px;
            }

            .control-group input[type="text"],
            .control-group textarea,
            .control-group select {
                padding: 8px 10px;
                font-size: 0.85rem;
            }

            .control-group textarea {
                min-height: 60px;
            }

            .color-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 5px;
            }

            .color-option {
                aspect-ratio: 1.2;
                font-size: 0.75rem;
            }

            .slider-container input[type="range"]::-webkit-slider-thumb {
                width: 14px;
                height: 14px;
            }

            .slider-value {
                font-size: 0.75rem;
                min-width: 35px;
            }

            .checkbox-container {
                padding: 8px;
            }

            .checkbox-container input[type="checkbox"] {
                width: 16px;
                height: 16px;
            }

            .checkbox-container span {
                font-size: 0.7rem;
            }

            .preview-container {
                padding: 15px;
                min-height: 260px;
            }

            .preview-label {
                font-size: 0.6rem;
                top: 10px;
                left: 12px;
            }

            #sticker-preview.square {
                width: 200px;
                height: 200px;
            }

            #sticker-preview.rectangle {
                width: 240px;
                height: 180px;
            }

            #sticker-preview {
                font-size: 0.75em;
            }

            .download-btn {
                padding: 12px 18px;
                font-size: 0.8rem;
                letter-spacing: 0.1em;
            }
        }

        /* Small mobile */
        @media (max-width: 360px) {
            .logo-section h1 {
                font-size: 1.3rem;
            }

            #sticker-preview.square {
                width: 180px;
                height: 180px;
            }

            #sticker-preview.rectangle {
                width: 220px;
                height: 165px;
            }

            .color-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 4px;
            }

            .color-option {
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="scanlines"></div>
    
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo-section">
                    <h1>NERV</h1>
                    <div class="subtitle">Sticker Generation System</div>
                </div>
                <div class="system-info">
                    <div class="status">● SYSTEM ONLINE</div>
                    <div class="time" id="system-time">00:00:00</div>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="controls">
                <div class="panel-header">
                    <h2>Control Parameters</h2>
                </div>
                <div class="panel-content">
                    <div class="control-group">
                        <label>Layout Mode</label>
                        <select id="layout-mode">
                            <option value="single">SINGLE TEXT</option>
                            <option value="header-main">HEADER + MAIN</option>
                        </select>
                    </div>

                    <div class="control-group" id="header-text-group" style="display: none;">
                        <label for="header-text">Header Text</label>
                        <input type="text" id="header-text" placeholder="Enter header text..." value="感謝老師賜飯">
                    </div>

                    <div class="control-group" id="main-text-group">
                        <label for="sticker-text">Main Text</label>
                        <textarea id="sticker-text" placeholder="Enter warning text...">吃得哭了</textarea>
                    </div>

                    <div class="control-group" id="header-size-group" style="display: none;">
                        <label>Header Font Size</label>
                        <div class="slider-container">
                            <input type="range" id="header-font-size" min="20" max="80" value="35">
                            <span class="slider-value" id="header-font-size-value">35px</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>Dimension Format</label>
                        <select id="dimension">
                            <option value="square">SQUARE [1:1]</option>
                            <option value="rectangle">RECTANGLE [4:3]</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label>Color Scheme</label>
                        <div class="color-grid">
                            <div class="color-option active" data-bg="#FF6B35" data-text="#FFFFFF" style="background: #FF6B35; color: #FFFFFF;" title="WARNING ORANGE">警</div>
                            <div class="color-option" data-bg="#7B1FA2" data-text="#FFFFFF" style="background: #7B1FA2; color: #FFFFFF;" title="NERV PURPLE">N</div>
                            <div class="color-option" data-bg="#000000" data-text="#00E676" style="background: #000000; color: #00E676;" title="MAGI TERMINAL">M</div>
                            <div class="color-option" data-bg="#D32F2F" data-text="#FFFFFF" style="background: #D32F2F; color: #FFFFFF;" title="ALERT RED">!</div>
                            <div class="color-option" data-bg="#FFC107" data-text="#000000" style="background: #FFC107; color: #000000;" title="AT FIELD">A</div>
                            <div class="color-option" data-bg="#212121" data-text="#00BCD4" style="background: #212121; color: #00BCD4;" title="CYAN TERMINAL">T</div>
                        </div>
                    </div>

                    <div class="control-group">
                        <label>Text Orientation</label>
                        <select id="orientation">
                            <option value="horizontal">HORIZONTAL</option>
                            <option value="vertical">VERTICAL</option>
                        </select>
                    </div>

                    <div class="control-group">
                        <label>Font Size Scale</label>
                        <div class="slider-container">
                            <input type="range" id="font-size" min="30" max="180" value="90">
                            <span class="slider-value">90px</span>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="checkbox-container">
                            <input type="checkbox" id="multi-line">
                            <span>ENABLE MULTI-LINE</span>
                        </label>
                    </div>

                    <div class="control-group">
                        <label class="checkbox-container">
                            <input type="checkbox" id="traditional-chinese">
                            <span>CONVERT TO TRADITIONAL (繁體)</span>
                        </label>
                    </div>
                </div>
            </div>

                    <div class="preview-section">
                <div class="preview-container">
                    <div class="preview-label">Output Preview</div>
                    <div id="sticker-preview" class="square">
                        <div class="sticker-header" style="display: none;"></div>
                        <div class="sticker-main"></div>
                    </div>
                </div>
                <div class="action-bar">
                    <button class="download-btn" onclick="downloadSticker()">
                        DOWNLOAD STICKER
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // Elements
        const stickerPreview = document.getElementById('sticker-preview');
        const stickerHeader = document.querySelector('.sticker-header');
        const stickerMain = document.querySelector('.sticker-main');
        const textInput = document.getElementById('sticker-text');
        const headerTextInput = document.getElementById('header-text');
        const dimensionSelect = document.getElementById('dimension');
        const orientationSelect = document.getElementById('orientation');
        const fontSizeSlider = document.getElementById('font-size');
        const fontSizeValue = document.querySelector('.slider-value');
        const headerFontSizeSlider = document.getElementById('header-font-size');
        const headerFontSizeValue = document.getElementById('header-font-size-value');
        const layoutModeSelect = document.getElementById('layout-mode');
        const headerTextGroup = document.getElementById('header-text-group');
        const headerSizeGroup = document.getElementById('header-size-group');
        const multiLineCheckbox = document.getElementById('multi-line');
        const traditionalCheckbox = document.getElementById('traditional-chinese');
        const colorOptions = document.querySelectorAll('.color-option');
        const systemTime = document.getElementById('system-time');

        let currentBg = '#FF6B35';
        let currentText = '#FFFFFF';

        // Simplified to Traditional Chinese conversion table (common characters)
        const s2tMap = {
            '简': '簡', '体': '體', '转': '轉', '换': '換', '警': '警', '告': '告',
            '禁': '禁', '止': '止', '入': '入', '内': '內', '危': '危', '险': '險',
            '注': '注', '意': '意', '紧': '緊', '急': '急', '停': '停', '止': '止',
            '出': '出', '口': '口', '入': '入', '口': '口', '撤': '撤', '退': '退',
            '避': '避', '难': '難', '攻': '攻', '击': '擊', '防': '防', '御': '禦',
            '战': '戰', '斗': '鬥', '准': '準', '备': '備', '完': '完', '了': '了',
            '启': '啟', '动': '動', '终': '終', '了': '了', '士': '士', '兵': '兵',
            '队': '隊', '员': '員', '指': '指', '挥': '揮', '官': '官', '令': '令',
            '状': '狀', '态': '態', '初': '初', '号': '號', '机': '機', '器': '器',
            '人': '人', '使': '使', '徒': '徒', '袭': '襲', '来': '來', '作': '作',
            '战': '戰', '新': '新', '世': '世', '纪': '紀', '福': '福', '音': '音',
            '战': '戰', '士': '士', '绝': '絕', '对': '對', '领': '領', '域': '域',
            '同': '同', '步': '步', '率': '率', '超': '超', '过': '過', '百': '百',
            '分': '分', '之': '之', '四': '四', '百': '百', '泛': '泛', '滥': '濫',
            '崩': '崩', '坏': '壞', '侵': '侵', '蚀': '蝕', '拒': '拒', '绝': '絕',
            '接': '接', '触': '觸', '暴': '暴', '走': '走', '觉': '覺', '醒': '醒',
            '共': '共', '鸣': '鳴', '第': '第', '三': '三', '新': '新', '东': '東',
            '京': '京', '市': '市', '总': '總', '部': '部', '基': '基', '地': '地',
            '实': '實', '验': '驗', '验': '驗', '插': '插', '入': '入', '栓': '栓',
            '驾': '駕', '驶': '駛', '舱': '艙', '临': '臨', '界': '界', '深': '深',
            '度': '度', '下': '下', '降': '降', '电': '電', '源': '源', '断': '斷',
            '开': '開', '连': '連', '接': '接', '切': '切', '换': '換', '模': '模',
            '式': '式', '选': '選', '择': '擇', '确': '確', '认': '認', '开': '開',
            '始': '始', '结': '結', '束': '束', '复': '復', '位': '位', '再': '再',
            '启': '啟', '动': '動', '强': '強', '制': '制', '射': '射', '出': '出',
            '弹': '彈', '射': '射', '器': '器', '整': '整', '备': '備', '就': '就',
            '绪': '緒', '维': '維', '护': '護', '修': '修', '复': '復', '检': '檢',
            '查': '查', '完': '完', '成': '成', '警': '警', '戒': '戒', '等': '等',
            '级': '級', '特': '特', '殊': '殊', '一': '一', '般': '般', '通': '通',
            '常': '常', '红': '紅', '橙': '橙', '黄': '黃', '绿': '綠', '蓝': '藍',
            '紫': '紫', '白': '白', '黑': '黑', '灰': '灰', '金': '金', '银': '銀'
        };

        function toTraditional(text) {
            if (!traditionalCheckbox.checked) return text;
            return text.split('').map(char => s2tMap[char] || char).join('');
        }

        // Update system time
        function updateTime() {
            const now = new Date();
            systemTime.textContent = now.toLocaleTimeString('en-US', { 
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Update preview
        function updatePreview() {
            const layoutMode = layoutModeSelect.value;
            const rawText = textInput.value || '警告';
            
            // Update layout mode class
            stickerPreview.classList.remove('single', 'header-main');
            stickerPreview.classList.add(layoutMode);
            
            if (layoutMode === 'header-main') {
                // Show header and main text
                stickerHeader.style.display = 'block';
                stickerHeader.textContent = toTraditional(headerTextInput.value || 'Header');
                stickerHeader.style.fontSize = headerFontSizeSlider.value + 'px';
                stickerMain.textContent = toTraditional(rawText);
                stickerMain.style.fontSize = fontSizeSlider.value + 'px';
            } else {
                // Single text mode
                stickerHeader.style.display = 'none';
                stickerMain.textContent = toTraditional(rawText);
                stickerMain.style.fontSize = fontSizeSlider.value + 'px';
            }
            
            stickerPreview.style.backgroundColor = currentBg;
            stickerPreview.style.color = currentText;
            
            // Update dimension
            stickerPreview.classList.remove('square', 'rectangle');
            stickerPreview.classList.add(dimensionSelect.value);
            
            // Update orientation
            if (orientationSelect.value === 'vertical') {
                stickerPreview.classList.add('vertical');
            } else {
                stickerPreview.classList.remove('vertical');
            }
            
            // Update multi-line
            if (multiLineCheckbox.checked) {
                stickerPreview.style.whiteSpace = 'pre-wrap';
            } else {
                stickerPreview.style.whiteSpace = 'nowrap';
            }
        }

        // Layout mode toggle
        layoutModeSelect.addEventListener('change', () => {
            const isHeaderMain = layoutModeSelect.value === 'header-main';
            headerTextGroup.style.display = isHeaderMain ? 'block' : 'none';
            headerSizeGroup.style.display = isHeaderMain ? 'block' : 'none';
            updatePreview();
        });

        headerTextInput.addEventListener('input', updatePreview);
        headerFontSizeSlider.addEventListener('input', (e) => {
            headerFontSizeValue.textContent = e.target.value + 'px';
            updatePreview();
        });

        // Color selection
        colorOptions.forEach(option => {
            option.addEventListener('click', () => {
                colorOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                currentBg = option.dataset.bg;
                currentText = option.dataset.text;
                updatePreview();
            });
        });

        // Event listeners
        textInput.addEventListener('input', updatePreview);
        dimensionSelect.addEventListener('change', updatePreview);
        orientationSelect.addEventListener('change', updatePreview);
        multiLineCheckbox.addEventListener('change', updatePreview);
        traditionalCheckbox.addEventListener('change', updatePreview);
        
        fontSizeSlider.addEventListener('input', (e) => {
            fontSizeValue.textContent = e.target.value + 'px';
            updatePreview();
        });

        // Download function
        function downloadSticker() {
            html2canvas(stickerPreview, {
                backgroundColor: null,
                scale: 2
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'nerv-sticker-' + Date.now() + '.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        // Initialize
        updatePreview();
    </script>
</body>
</html>